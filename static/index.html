<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIP-BOY 4000 — Local Agent</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="scanlines"></div>
    <div class="crt-vignette"></div>

    <!-- Setup: Ollama not installed -->
    <div class="setup-overlay" id="setupInstallOverlay">
        <div class="setup-modal">
            <div class="setup-header">
                <span class="setup-title">OLLAMA ENGINE NOT DETECTED</span>
            </div>
            <div class="setup-body">
<pre class="ascii-art setup-ascii">
  ╔═══════════════════════════════╗
  ║  !! ENGINE NOT FOUND !!      ║
  ║                               ║
  ║  Ollama is required to run    ║
  ║  local AI models.             ║
  ║                               ║
  ║  Download and install it to   ║
  ║  get started.                 ║
  ╚═══════════════════════════════╝
</pre>
                <p class="setup-desc">PIP-BOY 4000 needs Ollama to run AI models locally on your machine. It's free, open-source, and takes about a minute to install.</p>
            </div>
            <div class="setup-footer">
                <button class="pip-btn setup-action-btn" id="setupDownloadOllamaBtn">DOWNLOAD OLLAMA</button>
                <button class="pip-btn" id="setupInstallCheckBtn">CHECK AGAIN</button>
            </div>
        </div>
    </div>

    <!-- Setup: Ollama not running -->
    <div class="setup-overlay" id="setupStartOverlay">
        <div class="setup-modal">
            <div class="setup-header">
                <span class="setup-title">OLLAMA ENGINE OFFLINE</span>
            </div>
            <div class="setup-body">
<pre class="ascii-art setup-ascii">
  ╔═══════════════════════════════╗
  ║  OLLAMA: OFFLINE              ║
  ║                               ║
  ║  The engine is installed but  ║
  ║  not currently running.       ║
  ║                               ║
  ║  Open the Ollama app or run   ║
  ║  "ollama serve" in terminal.  ║
  ╚═══════════════════════════════╝
</pre>
                <p class="setup-desc">Ollama is installed but not running. Open <strong>Ollama.app</strong> from your Applications folder, or run <code>ollama serve</code> in a terminal.</p>
            </div>
            <div class="setup-footer">
                <span class="setup-status" id="setupStartStatus"></span>
                <button class="pip-btn" id="setupStartCheckBtn">CHECK AGAIN</button>
            </div>
        </div>
    </div>

    <!-- Setup: No models downloaded -->
    <div class="setup-overlay" id="setupDownloadOverlay">
        <div class="setup-modal setup-modal-wide">
            <div class="setup-header">
                <span class="setup-title">DOWNLOAD NEURAL PROCESSOR</span>
            </div>
            <div class="setup-body">
                <p class="setup-desc">No AI models found. Pick a model to download — smaller models are faster, larger models are smarter.</p>
                <div class="setup-model-list" id="setupModelList">
                    <!-- Populated by JS -->
                </div>
                <div class="setup-custom-input-wrapper">
                    <label class="setup-custom-label" for="setupCustomModel">Or enter a custom model name:</label>
                    <input type="text" class="setup-custom-input" id="setupCustomModel" placeholder="e.g. phi3:mini" spellcheck="false">
                </div>
                <div class="setup-progress-wrapper" id="setupProgressWrapper" style="display:none;">
                    <div class="setup-progress-status" id="setupProgressStatus">PREPARING DOWNLOAD...</div>
                    <div class="setup-progress-bar">
                        <div class="setup-progress-fill" id="setupProgressFill"></div>
                    </div>
                    <div class="setup-progress-detail" id="setupProgressDetail"></div>
                </div>
            </div>
            <div class="setup-footer">
                <span class="setup-status" id="setupDownloadStatus"></span>
                <button class="pip-btn setup-action-btn" id="setupPullBtn" disabled>DOWNLOAD</button>
            </div>
        </div>
    </div>

    <!-- First-launch model selection overlay -->
    <div class="model-select-overlay" id="modelSelectOverlay">
        <div class="model-select-modal">
            <div class="model-select-header">
                <span class="model-select-title">SELECT NEURAL PROCESSOR</span>
            </div>
            <div class="model-select-body">
                <p class="model-select-desc">No model configured. Choose a model to initialize the system.</p>
                <div class="model-select-list" id="modelSelectList">
                    <!-- Populated by JS -->
                </div>
            </div>
            <div class="model-select-footer">
                <span class="model-select-status" id="modelSelectStatus">SCANNING AVAILABLE MODELS...</span>
                <button class="pip-btn model-select-confirm" id="modelSelectConfirm" disabled>INITIALIZE</button>
            </div>
        </div>
    </div>

    <div class="pipboy-frame">
        <header class="pipboy-header">
            <div class="header-left">
                <span class="pip-logo">PIP-BOY 4000</span>
                <span class="pip-version">v1.0 LOCAL AGENT</span>
            </div>
            <div class="header-right">
                <select class="pip-select" id="modelSelect" title="Switch model">
                    <option value="">LOADING...</option>
                </select>
                <span class="model-indicator" id="modelIndicator">
                    <span class="indicator-dot"></span>
                    STANDBY
                </span>
                <button class="pip-btn think-btn active" id="thinkBtn" title="Toggle thinking mode">THINK</button>
                <button class="pip-btn" id="settingsBtn" title="System prompt settings">SYS</button>
                <button class="pip-btn" id="clearBtn" title="Clear conversation">CLR</button>
            </div>
        </header>

        <div class="pipboy-screen" id="chatScreen">
            <div class="welcome-message">
<pre class="ascii-art">╔══════════════════════════════════════════════╗
║                                              ║
║   PIP-BOY 4000 SURVIVAL ASSISTANT            ║
║                                              ║
║   NEURAL PROCESSOR: <span id="welcomeModel">INITIALIZING...          ║</span>
║                                              ║
║   SURVIVAL KNOWLEDGE .. ONLINE               ║
║   FIRST AID ........... ONLINE               ║
║   DISASTER RESPONSE ... ONLINE               ║
║   PRACTICAL SKILLS .... ONLINE               ║
║   STATUS .............. ALL SYSTEMS NOMINAL  ║
║                                              ║
╚══════════════════════════════════════════════╝</pre>
                <p class="welcome-sub">// All processing is local. No internet required. You are not alone.</p>
            </div>
        </div>

        <div class="pipboy-status" id="statusBar">
            <div class="status-content">
                <span class="status-text" id="statusText">READY</span>
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </div>

        <div class="pipboy-input">
            <span class="input-prompt">&gt;</span>
            <textarea
                id="userInput"
                placeholder="Enter query..."
                rows="1"
                autofocus
            ></textarea>
            <button class="pip-btn send-btn" id="sendBtn">SEND</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="settings-overlay" id="settingsOverlay">
        <div class="settings-modal">
            <div class="settings-header">
                <span class="settings-title">SYSTEM PROMPT EDITOR</span>
                <button class="pip-btn" id="settingsCloseBtn">ESC</button>
            </div>
            <div class="settings-body">
                <textarea id="promptEditor" spellcheck="false"></textarea>
            </div>
            <div class="settings-footer">
                <span class="settings-status" id="settingsStatus"></span>
                <div class="settings-actions">
                    <button class="pip-btn" id="promptResetBtn">RELOAD</button>
                    <button class="pip-btn settings-save-btn" id="promptSaveBtn">SAVE</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
